<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>使用 Phonegap + Cordova 搭建混合开发平台 | Sanonz</title><meta name="author" content="Sanonz"><meta name="keywords" content="Sanonz、Web、WebGL、Font End、Developer、Mini Program"><meta name="description" content="介绍使用 Cordova 工具，把 HTML5 打包为 IOS 及 Android 等应用，Cordova 提供了一组设备相关的 API，通过这组 API，移动应用能够用 JavaScript 访问原生的设备功能，如摄像头、麦克风等。Cordova 支持多个操作系统，例如：ios、android、brower、electron、oxs、windows。作者所使用的环境macOS — High Sierra 10.15.5xcode — v11.5.0Android Studio — v4.0.0"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><link rel="alternate" href="/atom.xml" title="Sanonz" type="application/atom+xml"><link rel="icon" href="/images/favicon.ico"><style type="text/css">@font-face{font-family:icomoon;src:url(/fonts/icomoon.eot?q628ml);src:url(/fonts/icomoon.eot?q628ml#iefix) format('embedded-opentype'),url(/fonts/icomoon.ttf?q628ml) format('truetype'),url(/fonts/icomoon.woff?q628ml) format('woff'),url(/fonts/icomoon.svg?q628ml#icomoon) format('svg');font-weight:400;font-style:normal}</style><link rel="stylesheet" href="/css/style.css"><!--[if lt IE 9]><style type="text/css">.nav-inner {top:0;}.author-meta {position:static;top:0;}.search-form {height:36px;}</style><script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]--><meta name="generator" content="Hexo 4.2.1"></head><body><main class="app"><header id="header" class="header clearfix"><div id="nav" class="nav"><div class="nav-mobile"><button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button><h1 class="nav-mobile-title nav-mobile-item">Sanonz</h1><button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button></div><nav id="nav-inner" class="nav-inner"><a class="nav-item" href="/"><span class="nav-text">首页</span> </a><a class="nav-item" href="/categories/front-end"><span class="nav-text">前端</span> </a><a class="nav-item" href="/categories/back-end"><span class="nav-text">后端</span> </a><a class="nav-item" href="/tags"><span class="nav-text">标签</span> </a><a class="nav-item" href="/archives"><span class="nav-text">归档</span> </a><a class="nav-item" href="/atom.xml"><span class="nav-text">订阅</span> </a><a class="nav-item" href="/about"><span class="nav-text">关于</span></a></nav></div><aside id="aside" class="aside"><div id="aside-mask" class="aside-mask"></div><div id="aside-inner" class="aside-inner"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://sanonz.github.io"></form><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#介绍"><span class="toc-number">1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#作者所使用的环境"><span class="toc-number">2.</span> <span class="toc-text">作者所使用的环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装依赖"><span class="toc-number">3.</span> <span class="toc-text">安装依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cordova"><span class="toc-number">3.1.</span> <span class="toc-text">Cordova</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Phonegap"><span class="toc-number">3.2.</span> <span class="toc-text">Phonegap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Android-SDK"><span class="toc-number">3.3.</span> <span class="toc-text">Android SDK</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JDK-版本设置"><span class="toc-number">3.3.1.</span> <span class="toc-text">JDK 版本设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Gradle-版本设置"><span class="toc-number">3.3.2.</span> <span class="toc-text">Gradle 版本设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Platform-SDK-版本设置"><span class="toc-number">3.3.3.</span> <span class="toc-text">Android Platform SDK 版本设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-SDK-build-tools-版本设置"><span class="toc-number">3.3.4.</span> <span class="toc-text">Android SDK build-tools 版本设置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置环境变量"><span class="toc-number">3.4.</span> <span class="toc-text">设置环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#检查环境"><span class="toc-number">3.5.</span> <span class="toc-text">检查环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建一个项目"><span class="toc-number">4.</span> <span class="toc-text">创建一个项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建-Hello-项目"><span class="toc-number">4.1.</span> <span class="toc-text">创建 Hello 项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加平台"><span class="toc-number">4.2.</span> <span class="toc-text">添加平台</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加签名"><span class="toc-number">4.3.</span> <span class="toc-text">添加签名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建签名配置文件"><span class="toc-number">4.3.1.</span> <span class="toc-text">创建签名配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IOS-签名"><span class="toc-number">4.3.2.</span> <span class="toc-text">IOS 签名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-签名"><span class="toc-number">4.3.3.</span> <span class="toc-text">Android 签名</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构建-APP"><span class="toc-number">4.4.</span> <span class="toc-text">构建 APP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试-APP"><span class="toc-number">4.5.</span> <span class="toc-text">测试 APP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Live-Reload"><span class="toc-number">4.6.</span> <span class="toc-text">Live Reload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">5.</span> <span class="toc-text">小结</span></a></li></ol></div></aside></header><div id="content" class="content"><div id="wrapper" class="wrapper"><article class="article" itemscope itemprop="blogPost"><header class="article-header"><h1 itemprop="name">使用 Phonegap + Cordova 搭建混合开发平台</h1><div class="article-meta clearfix"><a class="article-date" href="https://sanonz.github.io/2020/make-hybrid-platform-cordova/index.html"><i class="icon-calendar vm"></i> <time class="vm" datetime="2020-06-10T22:20:53.000Z" itemprop="datePublished">2020-06-11</time></a><div class="article-tag-list"><i class="icon-tag vm"></i> <a class="article-tag-link" href="/tags/Cordov/" rel="tag">Cordov</a>, <a class="article-tag-link" href="/tags/Phonegap/" rel="tag">Phonegap</a></div></div></header><section class="article-body markdown-body"><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>使用 Cordova 工具，把 HTML5 打包为 IOS 及 Android 等应用，Cordova 提供了一组设备相关的 API，通过这组 API，移动应用能够用 JavaScript 访问原生的设备功能，如摄像头、麦克风等。Cordova 支持多个操作系统，例如：ios、android、brower、electron、oxs、windows。</p><h2 id="作者所使用的环境"><a href="#作者所使用的环境" class="headerlink" title="作者所使用的环境"></a>作者所使用的环境</h2><ol><li>macOS — High Sierra 10.15.5</li><li>xcode — v11.5.0</li><li>Android Studio — v4.0.0</li><li>Node.js — v14.2.0</li><li>Phonegap — v9.0.0</li><li>Apache Cordova — v9.0.0</li></ol><a id="more"></a><h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><h3 id="Cordova"><a href="#Cordova" class="headerlink" title="Cordova"></a>Cordova</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install cordova -g</span><br></pre></td></tr></table></figure><h3 id="Phonegap"><a href="#Phonegap" class="headerlink" title="Phonegap"></a>Phonegap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install phonegap -g</span><br></pre></td></tr></table></figure><h3 id="Android-SDK"><a href="#Android-SDK" class="headerlink" title="Android SDK"></a>Android SDK</h3><p>安装 <a href="https://developer.android.com/studio/index.html" target="_blank" rel="noopener">Android Studio</a>，建议使用默认安装，装好之后启动软件，需要根据项目所安装的 <a href="https://www.npmjs.com/package/cordova-android/v/10.1.1" target="_blank" rel="noopener">cordova-android</a> 版本不同进行不同的设置。</p><p>主要关注四个设置点：</p><ol><li>JDK</li><li>Gradle</li><li>Android Platform SDK</li><li>Android SDK build-tools</li></ol><p>这四个地方版本对应上了就可以了，在这里可以查看需要设置成什么版本：<a href="https://cordova.apache.org/docs/en/10.x/guide/platforms/android/index.html" target="_blank" rel="noopener">https://cordova.apache.org/docs/en/10.x/guide/platforms/android/index.html</a> 注意 URL 的 <code>10.x</code>，这个就是 <code>cordova-android</code> 的版本，进入到页面右上角可以切换版本，根据你项目安装的版本，在这个页面中找到这四个地方所需要包含的版本，<code>10.x</code> 所包含的版本如下：</p><ol><li>JDK: 8 (1.8.*)</li><li>Gradle: 6.4.0</li><li>Android Platform SDK: 29 (Q)</li><li>Android SDK build-tools: 29.0.2</li></ol><p>接下来将一一详细介绍怎么设置</p><h4 id="JDK-版本设置"><a href="#JDK-版本设置" class="headerlink" title="JDK 版本设置"></a>JDK 版本设置</h4><p>打开 <code>Android Studio &gt; Preferences... &gt; Build, Execution, Deployment &gt; Build Tools &gt; Gradle</code> 找到 <code>Gradle JDK:</code> 选择框，点击选择 <code>Download JDK</code> 进行设置版本，比如我们现在用的 <code>10.x</code> 的 <code>JDK</code> 依赖是 <code>JDK 8</code>，那么 <code>Version:</code> 这里就需要选择 <code>1.8</code> 版本（这里说下 <code>JDK 7</code> 就对应 <code>1.7</code>，<code>8</code> 就对应 <code>1.8</code>），<code>Vendor:</code> 默认就好，<code>Location:</code> 这里复制出来拼接 <code>/Contents/Home</code> 加到环境变量，详细请看下方 <a href="#设置环境变量">设置环境变量</a> <code>Java</code> 注释部分</p><h4 id="Gradle-版本设置"><a href="#Gradle-版本设置" class="headerlink" title="Gradle 版本设置"></a>Gradle 版本设置</h4><p>打开 <code>File &gt; Project Structure &gt; Project</code>，<code>Android Gradle Plugin Version</code> 选择 <code>4.0.0</code>，<code>Gradle Version</code> 选择 <code>6.4</code>，点击确认等待下载完成</p><h4 id="Android-Platform-SDK-版本设置"><a href="#Android-Platform-SDK-版本设置" class="headerlink" title="Android Platform SDK 版本设置"></a>Android Platform SDK 版本设置</h4><p>打开 <code>Android Studio &gt; Preferences &gt; Appearance &amp; Behavior &gt; System Settings &gt; Android SDK</code>，选择 <code>SDK Platforms</code> 标签，勾选对应的 <a href="https://developer.android.com/guide/topics/manifest/uses-sdk-element.html#ApiLevels" target="_blank" rel="noopener">API Level</a> 来安装 Cordova 所依赖的 SDK，最新的 Cordova 所支持的 API Level 版本为 29，具体 Cordova 版本所对应的 SDK 可看下表，在你看到这篇文章时，当前表格可能已经过时，可以到 <a href="https://cordova.apache.org/docs/en/10.x/guide/platforms/android/index.html#requirements-and-support" target="_blank" rel="noopener">官方网站</a> 查看最新表格，查看表格时不要忘记选择你项目对应的版本。</p><table><thead><tr><th>Cordova 版本</th><th>API Level 版本</th><th>对应 Android 版本</th></tr></thead><tbody><tr><td>9.X.X</td><td>22 - 29</td><td>5.1 - 10.0.0</td></tr><tr><td>8.X.X</td><td>19 - 28</td><td>4.4 - 9.0.0</td></tr><tr><td>7.X.X</td><td>19 - 27</td><td>4.4 - 8.1</td></tr><tr><td>6.X.X</td><td>16 - 26</td><td>4.1 - 8.0.0</td></tr><tr><td>5.X.X</td><td>14 - 23</td><td>4.0 - 6.0.1</td></tr><tr><td>4.1.X</td><td>14 - 22</td><td>4.0 - 5.1</td></tr><tr><td>4.0.X</td><td>10 - 22</td><td>2.3.3 - 5.1</td></tr><tr><td>3.7.X</td><td>10 - 21</td><td>2.3.3 - 5.0.2</td></tr></tbody></table><h4 id="Android-SDK-build-tools-版本设置"><a href="#Android-SDK-build-tools-版本设置" class="headerlink" title="Android SDK build-tools 版本设置"></a>Android SDK build-tools 版本设置</h4><p>打开 <code>Android Studio &gt; Preferences &gt; Appearance &amp; Behavior &gt; System Settings &gt; Android SDK</code>，选择 <code>SDK Tools</code> 标签，勾选最下方 <code>Show Package Details</code> 复选框，展开 <code>Android SDK Build-Tools</code>，勾选 <code>29.0.2</code> 版本</p><h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><p>在 <code>~/.bash_profile</code> 或者 <code>~/.zshenv</code> 文件中追加以下内容。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Java</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=<span class="variable">$&#123;HOME&#125;</span>/Library/Java/JavaVirtualMachines/corretto-1.8.0_312/Contents/Home</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gradle</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;PATH&#125;</span>:<span class="variable">$&#123;HOME&#125;</span>/.gradle/wrapper/dists/gradle-6.4-bin/aj6cyggqps6mdbpl6cfppfwqk/gradle-6.4/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># Android</span></span><br><span class="line"><span class="built_in">export</span> ANDROID_SDK_ROOT=<span class="variable">$&#123;HOME&#125;</span>/Library/Android/sdk</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;PATH&#125;</span>:<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="variable">$&#123;ANDROID_SDK_ROOT&#125;</span>/emulator:<span class="variable">$&#123;ANDROID_SDK_ROOT&#125;</span>/platform-tools:<span class="variable">$&#123;ANDROID_SDK_ROOT&#125;</span>/tools</span><br></pre></td></tr></table></figure><h3 id="检查环境"><a href="#检查环境" class="headerlink" title="检查环境"></a>检查环境</h3><p>确保 <code>Java JDK</code>、<code>Android SDK</code>、<code>Android target</code>、<code>Gradle</code> 是正常的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ cordova requirements</span><br><span class="line"></span><br><span class="line">Requirements check results <span class="keyword">for</span> android:</span><br><span class="line">Java JDK: installed 1.8.0</span><br><span class="line">Android SDK: installed <span class="literal">true</span></span><br><span class="line">Android target: installed android-29,android-28,android-26</span><br><span class="line">Gradle: installed /usr/<span class="built_in">local</span>/Cellar/gradle/6.4/bin/gradle</span><br><span class="line"></span><br><span class="line">Requirements check results <span class="keyword">for</span> browser:</span><br><span class="line"></span><br><span class="line">Requirements check results <span class="keyword">for</span> ios:</span><br><span class="line">Apple macOS: installed darwin</span><br><span class="line">Xcode: installed 11.5</span><br><span class="line">ios-deploy: not installed </span><br><span class="line">ios-deploy was not found. Please download, build and install version 1.9.2 or greater from https://github.com/ios-control/ios-deploy into your path, or <span class="keyword">do</span> <span class="string">'npm install -g ios-deploy'</span></span><br><span class="line">CocoaPods: installed 1.9.1</span><br><span class="line">Some of requirements check failed</span><br></pre></td></tr></table></figure><h2 id="创建一个项目"><a href="#创建一个项目" class="headerlink" title="创建一个项目"></a>创建一个项目</h2><h3 id="创建-Hello-项目"><a href="#创建-Hello-项目" class="headerlink" title="创建 Hello 项目"></a>创建 Hello 项目</h3><p>执行以下命令创建一个 Cordova 项目。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova create hello com.example.hello HelloWorld</span><br></pre></td></tr></table></figure><p>默认创建的项目只支持 WEB 端，资源放在项目下的 <code>www</code> 目录，主页文件在 <code>www/index.html</code>。</p><h3 id="添加平台"><a href="#添加平台" class="headerlink" title="添加平台"></a>添加平台</h3><p>进入到项目目录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> hello</span><br></pre></td></tr></table></figure><p>添加 IOS 与 Android 平台支持。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cordova platform add ios</span><br><span class="line">$ cordova platform add android</span><br></pre></td></tr></table></figure><blockquote><p>添加的平台在 <code>platforms</code> 目录下，到此目录下你可以看到多了两个刚刚添加的 <code>ios</code> 与 <code>android</code> 目录。此目录为自动生成，官方不建议修改此目录内容，因为当执行构建 APP 命令或者删除平台在重新添加时，此目录会重新生成，你修改的内容将会丢失。</p></blockquote><p>查看当前已经添加过的平台列表。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ cordova platform ls</span><br><span class="line">Installed platforms:</span><br><span class="line">  android 8.1.0</span><br><span class="line">  browser 6.0.0</span><br><span class="line">  ios 5.1.1</span><br><span class="line">Available platforms: </span><br><span class="line">  electron ^1.0.0</span><br><span class="line">  osx ^5.0.0</span><br><span class="line">  windows ^7.0.0</span><br></pre></td></tr></table></figure><h3 id="添加签名"><a href="#添加签名" class="headerlink" title="添加签名"></a>添加签名</h3><h4 id="创建签名配置文件"><a href="#创建签名配置文件" class="headerlink" title="创建签名配置文件"></a>创建签名配置文件</h4><p>创建 <code>signing</code> 目录，在此目录下新建 <code>config.json</code> 文件，内容为以下格式。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"ios"</span>: &#123;</span><br><span class="line">    <span class="attr">"debug"</span>: &#123;</span><br><span class="line">      <span class="attr">"codeSignIdentity"</span>: <span class="string">"iPhone Developer"</span>,</span><br><span class="line">      <span class="attr">"developmentTeam"</span>: <span class="string">"FG35JLLMXX4A"</span>,</span><br><span class="line">      <span class="attr">"packageType"</span>: <span class="string">"development"</span>,</span><br><span class="line">      <span class="attr">"automaticProvisioning"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">"buildFlag"</span>: [</span><br><span class="line">        <span class="string">"EMBEDDED_CONTENT_CONTAINS_SWIFT = YES"</span>,</span><br><span class="line">        <span class="string">"ALWAYS_EMBED_SWIFT_STANDARD_LIBRARIES=NO"</span>,</span><br><span class="line">        <span class="string">"LD_RUNPATH_SEARCH_PATHS = \"@executable_path/Frameworks\""</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"release"</span>: &#123;</span><br><span class="line">      <span class="attr">"codeSignIdentity"</span>: <span class="string">"iPhone Developer"</span>,</span><br><span class="line">      <span class="attr">"developmentTeam"</span>: <span class="string">"FG35JLLMXX4A"</span>,</span><br><span class="line">      <span class="attr">"packageType"</span>: <span class="string">"app-store"</span>,</span><br><span class="line">      <span class="attr">"automaticProvisioning"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">"buildFlag"</span>: [</span><br><span class="line">        <span class="string">"EMBEDDED_CONTENT_CONTAINS_SWIFT = YES"</span>,</span><br><span class="line">        <span class="string">"ALWAYS_EMBED_SWIFT_STANDARD_LIBRARIES=NO"</span>,</span><br><span class="line">        <span class="string">"LD_RUNPATH_SEARCH_PATHS = \"@executable_path/Frameworks\""</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"android"</span>: &#123;</span><br><span class="line">    <span class="attr">"debug"</span>: &#123;</span><br><span class="line">      <span class="attr">"keystore"</span>: <span class="string">"./android.keystore"</span>,</span><br><span class="line">      <span class="attr">"storePassword"</span>: <span class="string">"sanonz"</span>,</span><br><span class="line">      <span class="attr">"alias"</span>: <span class="string">"sanonz"</span>,</span><br><span class="line">      <span class="attr">"password"</span> : <span class="string">"sanonz"</span>,</span><br><span class="line">      <span class="attr">"keystoreType"</span>: <span class="string">"jks"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"release"</span>: &#123;</span><br><span class="line">      <span class="attr">"keystore"</span>: <span class="string">"./android.keystore"</span>,</span><br><span class="line">      <span class="attr">"storePassword"</span>: <span class="string">"sanonz"</span>,</span><br><span class="line">      <span class="attr">"alias"</span>: <span class="string">"sanonz"</span>,</span><br><span class="line">      <span class="attr">"password"</span> : <span class="string">"sanonz"</span>,</span><br><span class="line">      <span class="attr">"keystoreType"</span>: <span class="string">"jks"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="IOS-签名"><a href="#IOS-签名" class="headerlink" title="IOS 签名"></a>IOS 签名</h4><p>注册一个苹果开发着账号，配置 <code>ios.{env}.developmentTeam</code> 为你的 <a href="https://developer.apple.com/account/#/membership/" target="_blank" rel="noopener">Team ID</a>。</p><h4 id="Android-签名"><a href="#Android-签名" class="headerlink" title="Android 签名"></a>Android 签名</h4><p>执行以下命令，密码使用 <code>sanonz</code>，当使用自己的密码时需要对应更改 <code>android.{env}.password</code> 与 <code>android.storePassword</code> 密码，同理别名 <code>-alias</code> 也需要对应修改。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ keytool -genkey -v -keystore android.keystore -keyalg RSA -keysize 2048 -validity 36500 -<span class="built_in">alias</span> sanonz</span><br></pre></td></tr></table></figure><p>其中 <code>android.{env}.keystore</code> 填写生成的 <code>android.keystore</code> 文件路径。</p><h3 id="构建-APP"><a href="#构建-APP" class="headerlink" title="构建 APP"></a>构建 APP</h3><p>构建所有添加的平台。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova build</span><br></pre></td></tr></table></figure><p>构建指定平台。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova build ios</span><br></pre></td></tr></table></figure><p>构建 debug 版本。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova build android --verbose --device --debug --buildConfig=./signing/config.json</span><br></pre></td></tr></table></figure><p>构建成功后的 apk 文件在 <code>platforms/android/app/build/outputs/apk/debug/app-debug.apk</code>。</p><p>构建 release 版本。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova build android --verbose --device --release --buildConfig=./signing/config.json</span><br></pre></td></tr></table></figure><p>构建成功后的 apk 文件在 <code>platforms/android/app/build/outputs/apk/release/app-release.apk</code>。</p><h3 id="测试-APP"><a href="#测试-APP" class="headerlink" title="测试 APP"></a>测试 APP</h3><p>以下命令会构建一个 debug 版本的 APP，自动打开模拟器并安装到模拟器上运行。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova run android</span><br></pre></td></tr></table></figure><h3 id="Live-Reload"><a href="#Live-Reload" class="headerlink" title="Live Reload"></a>Live Reload</h3><p>利用 Phonegap 的应用，可以实时预览你的 APP，首先安装 Phonegap 的 <a href="http://docs.phonegap.com/getting-started/2-install-mobile-app/" target="_blank" rel="noopener">APP</a>，由于 AppStore 在 2018 年下架了 Phonegap APP，所以直接安装不了，可以克隆官方的 <a href="https://github.com/phonegap/phonegap-app-developer" target="_blank" rel="noopener">Phonegap 仓库</a> 自行编译安装，安装到手机有点麻烦，不过可以很容易安装的模拟器上，在模拟器上打开 Phonegap APP 一样可以方便的预览。</p><p>启动调试服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ phonegap serve</span><br><span class="line">[phonegap] starting app server...</span><br><span class="line">[phonegap] listening on 192.168.1.103:3000</span><br><span class="line">[phonegap] </span><br><span class="line">[phonegap] ctrl-c to stop the server</span><br></pre></td></tr></table></figure><p>启动后控制台会打印 IP 地址，默认端口为 <code>3000</code>，打开 Phonegap APP，在 <code>Server Address</code> 输入框中输入控制台打印的 <code>192.168.1.103:3000</code> 地址，然后点击 <code>Connect</code> 链接按钮，连接成功后就可以查看你的 APP，修改 <code>wwww/index.html</code> 文件，保存后 Phonegap APP 会自动刷新，展示修改后的页面。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>至此结束，感谢阅读。</p></section></article><div class="comments"><div id="comments"></div><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script>new Gitalk({clientID:"2f728eb14f7e549408f7",clientSecret:"90be74e913959dcf39fbfed54458bdd20f95ac30",repo:"sanonz.github.io",owner:"sanonz",admin:["sanonz"],id:"c7c7bfef9b62e72dc6d3c0640e8b37f6",distractionFreeMode:!0,title:"使用 Phonegap + Cordova 搭建混合开发平台",body:"https://sanonz.github.io/2020/make-hybrid-platform-cordova/",labels:["Cordov","Phonegap"]}).render("comments")</script></div></div></div><a id="pagenext" href="/2020/deploy-a-hexo-blog-from-github-actions/" class="article-next" title="利用 Github Actions 自动部署 Hexo 博客"><i class="icon-arrow-right"></i></a> <a id="pageprev" href="/2020/state-management-and-performance-optimization-for-react-context-api-with-hooks/" class="article-prev" title="使用 React Context API 和 Hooks 实现全局状态管理和性能优化"><i class="icon-arrow-left"></i></a><footer class="footer">Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?e4027971a230b210f4671f485b33846a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></footer></main><script type="text/javascript" src="https://unpkg.com/jquery@1.9.1/jquery.min.js"></script><script type="text/javascript">$(function(){var n={nav:$("#nav"),aside:$("#aside"),asideInner:$("#aside-inner"),navInner:$("#nav-inner")},e=!1;function i(){"none"!==n.navInner.css("display")&&n.navInner.css("display","")}n.asideInner.on("webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend",function(){n.aside.hasClass("mobile-open")?n.aside.removeClass("mobile-open"):n.aside.removeClass("mobile-close panel-show"),e=!1}),$("#open-panel, #aside-mask").on("click",function(){e||(n.aside.hasClass("panel-show")?n.aside.addClass("mobile-close"):n.aside.addClass("mobile-open panel-show"))}),$("#open-menus").on("click",function(){n.navInner.slideToggle("normal",i)}),window.innerWidth<=960&&setTimeout(function(){n.navInner.slideUp("normal",i)},3e3),$(window).on("resize",function(){960<$(this).width()&&n.navInner.css("display","")})})</script><script src="/js/scrollspy.min.js"></script><script type="text/javascript">$(document.body).scrollspy({target:"#aside-inner"}),$(window).on("resize",function(){var e=$("#header").width(),t=$("#wrapper").width(),i=($(this).width()-e-t)/2/2,r=$("#pageprev"),d=$("#pagenext"),s=(r.width()+d.width())/2;if(s<i){var n=i-s/2,o={position:"fixed",top:"50%",marginTop:-(r.width()+d.width())/4};r.css($.extend({left:e+n},o)),d.css($.extend({right:n},o))}else r.removeAttr("style"),d.removeAttr("style")}).trigger("resize")</script></body></html>